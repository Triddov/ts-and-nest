флаг логирования должен зависеть от режима
сделать асинхронные методы с fs

